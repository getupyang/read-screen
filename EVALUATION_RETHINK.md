# 评测体系反思 - 基于真实用户反馈

**创建时间**: 2025-12-04
**背景**: v2 策略出现严重幻觉问题，需要重新思考评测标准和 prompt 设计

---

## 📊 问题诊断

### 用户 Case：Anthropic 报告截图

**用户输入**：
- 截图内容：Anthropic 发布报告相关视频
- 用户说明："今天刷到的视频"
- 当前时间：2025年12月4日

**AI 输出问题**：
1. ❌ 发布时间：2024年12月（错误，应该是2025年11-12月）
2. ❌ 链接：给出 404 错误的链接（编造）
3. ❌ 金句：只有英文，没有中文翻译
4. ❌ 不确定是否真正调用了搜索功能

**用户反馈**：
> "幻觉很严重...发布时间肯定是错的...网址也是错的，打开是404...这是非常严重的幻觉，不知道你在搜什么"

---

## 🔍 根本原因分析

### 1. Google Search Grounding 可能未生效

**怀疑**：
- 配置可能不正确
- 或者 AI 没有真正调用搜索
- 或者搜索结果质量差，AI 选择了错误的信息

**验证方法**：
- 需要查看 Gemini API 的搜索响应
- 可能需要检查 `tools: [{ googleSearch: {} }]` 配置是否正确

### 2. Prompt 结构问题

**当前问题**：
- Prompt 太长（135行），AI 可能遗漏关键指令
- 多层嵌套结构（步骤1、步骤2、步骤3...），不够直接
- "必须"、"禁止"等强制性语言可能不够有效

**改进方向**：
- 简化 prompt 结构
- 使用更直接的指令
- 减少嵌套层级

### 3. 缺乏验证机制

**当前问题**：
- AI 输出后无法验证
- 没有中间步骤日志
- 无法知道 AI 是否真的搜索了

**改进方向**：
- 要求 AI 输出搜索关键词
- 要求 AI 说明信息来源
- 添加置信度标记

---

## 🎯 重新设计评测标准

### 旧标准（20+50+30）的问题

**问题1：权重分配不合理**
- 实体识别（20分）- 太低，这是基础
- 增量价值（50分）- 太高，但很难量化
- 实用性（30分）- 包含太多子项

**问题2：缺少准确性维度**
- 没有评估链接是否可用
- 没有评估时间是否正确
- 没有评估信息是否可验证

### 新标准提案（40+30+30）

#### 维度1：准确性（40分）★ 最重要
因为错误的信息比没有信息更糟糕

**1.1 链接可用性（20分）**
- 20分：所有链接可访问
- 10分：部分链接可访问
- 5分：标注"暂无链接"
- 0分：给出错误/404链接（严重扣分）

**1.2 时间准确性（10分）**
- 10分：时间准确（±1个月）
- 5分：时间大致正确（±6个月）
- 0分：时间明显错误（超过1年差距）

**1.3 信息可验证性（10分）**
- 10分：提供明确来源和引用
- 5分：提供部分来源
- 0分：无法验证的信息

#### 维度2：增量价值（30分）
评估是否提供了截图之外的新信息

**2.1 信息增量（20分）**
- 20分：提供了丰富的背景、数据、分析
- 10分：提供了部分新信息
- 0分：只是重复截图内容

**2.2 避免重复（10分）**
- 10分：完全没有重复截图内容
- 5分：轻微重复
- 0分：大量重复（>50%）

#### 维度3：实用性（30分）
评估对用户的实际帮助

**3.1 可操作资源（15分）**
- 15分：提供官方链接、下载地址等
- 10分：提供部分资源
- 5分：说明"未找到资源"但建议查找方向
- 0分：没有任何资源指引

**3.2 金句/引用（10分）**
- 10分：提供中英文对照的原文引用
- 5分：只有英文或中文
- 0分：没有引用

**3.3 内容可读性（5分）**
- 5分：结构清晰，markdown格式正确
- 2分：基本可读
- 0分：格式混乱

---

## 📝 Prompt 重新设计

### 设计原则

1. **简洁性**：核心指令控制在50行以内
2. **直接性**：避免多层嵌套，使用平铺结构
3. **可验证性**：要求AI说明信息来源
4. **防御性**：明确"不知道就说不知道"

### 新 Prompt 结构

```markdown
# 角色
你是知识卡片生成助手，帮助用户从截图中提取并扩展知识。

# 当前上下文
- 今天日期：2025年12月4日
- 用户看到的是"最近"、"今天"的内容，通常发布于最近1-2个月内

# 核心任务
1. 分析截图，识别主要实体（报告、文章、产品等）
2. **搜索验证**该实体的准确信息
3. 生成1张卡片（聚焦用户关心的主要内容）

# 搜索要求
你必须搜索以下信息：
- 准确名称
- 真实发布时间（结合"今天"、"最近"等线索判断）
- 官方链接（必须可访问）
- 核心内容

## 搜索验证清单
在输出前，回答这些问题：
- [ ] 我搜索了哪些关键词？
- [ ] 搜索到的发布时间是什么？
- [ ] 搜索到的链接是什么？
- [ ] 我验证过链接是否可访问了吗？

# 输出格式

**标题**：简短有吸引力（≤15字）

**摘要**：一句话总结

**正文**：
- 提供截图之外的新信息
- 使用markdown格式
- 如果找到链接：[文本](URL)
- 如果没找到：明确说"暂无官方链接，建议访问 XX 官网查询"

**金句**（如有）：
> "英文原文"
>
> 「中文翻译」

**信息来源**：说明你从哪里获取的信息

# 严格禁止
- ❌ 编造链接（如果不确定，不要给）
- ❌ 编造时间（如果不确定，说"发布时间未找到"）
- ❌ 重复截图内容
- ❌ 英文金句不翻译

# 输出原则
**真实 > 完整**
宁可说"未找到"，也不要猜测或编造。
```

---

## 🧪 测试计划

### 测试用例1：Anthropic 报告（当前失败的案例）

**输入**：
- 截图：提到 Anthropic 报告的视频
- 用户说明："今天刷到的"

**期望输出**：
- 发布时间：2025年11-12月
- 链接：可访问的官方链接，或明确说"暂无链接"
- 金句：中英文对照
- 信息来源：说明从哪里获取

**评分标准**：
- 准确性：40分（链接20+时间10+来源10）
- 增量价值：30分（新信息20+避免重复10）
- 实用性：30分（资源15+金句10+可读性5）

### 测试用例2：产品介绍

**输入**：截图介绍某个新产品

**期望输出**：
- 产品官网
- 核心功能（非截图中的）
- 使用场景
- 定价信息（如有）

---

## 🚀 下一步行动

1. **验证 Google Search 配置**
   - 检查 API 调用是否正确
   - 查看是否有搜索日志

2. **简化 Prompt**
   - 将当前135行 prompt 精简到50行
   - 平铺结构，避免嵌套

3. **添加调试模式**
   - 让 AI 输出搜索关键词
   - 让 AI 说明信息来源

4. **重新测试**
   - 使用 Anthropic 案例
   - 对比 v1 vs v2 输出

5. **更新评测脚本**
   - 实现新的评分标准（40+30+30）
   - 自动检测链接是否可访问
